# sky.yaml

resources:
  cloud: gcp
  zone: europe-west4-a
  accelerators: tpu-v3-32
  accelerator_args:
    runtime_version: tpu-vm-base
    tpu_vm: True

file_mounts:
  /ckpts:
    name: # Fill in a unique name for each spot job
    mode: MOUNT

  ~/.netrc: ~/.netrc

workdir: .

setup: |
  pip install "jax[tpu]" -f https://storage.googleapis.com/jax-releases/libtpu_releases.html
  pip install -r requirements.txt

run: |
  python -u train.py --run_id $SKYPILOT_RUN_ID
